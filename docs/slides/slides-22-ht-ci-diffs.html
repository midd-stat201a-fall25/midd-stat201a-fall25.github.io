<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-04-17">

<title>HTs and CIs for differences – STAT 201: Intro. to Statistics and Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-642b61e8dd9daef820930ed0a6efefa9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT 201: Intro. to Statistics and Data Science</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://openintro-ims.netlify.app/"> <i class="bi bi-book-half" role="img">
</i> 
<span class="menu-text">Textbook</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://middlebury.instructure.com/"> <i class="bi bi-bar-chart-fill" role="img">
</i> 
<span class="menu-text">Canvas</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="slides-22-ht-ci-diffs.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">HTs and CIs for differences</h1>
<p class="subtitle lead">Difference in means and proportions</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 17, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="housekeeping" class="level2">
<h2 class="anchored" data-anchor-id="housekeeping">Housekeeping</h2>
<ul>
<li>Project proposals due tonight!</li>
</ul>
</section>
<section id="recap" class="level2">
<h2 class="anchored" data-anchor-id="recap">Recap</h2>
<ul>
<li><p>Test and CI for a single mean</p>
<ul>
<li><p>If we know <span class="math inline">\(\sigma\)</span>, use standard Normal distribution</p></li>
<li><p>If we don’t know <span class="math inline">\(\sigma\)</span> and only have access to <span class="math inline">\(s\)</span>, use <span class="math inline">\(t\)</span> distribution</p></li>
</ul></li>
</ul>
</section>
<section id="difference-in-two-proportions" class="level1">
<h1>Difference in two proportions</h1>
<p>Now suppose we have samples of binary outcomes from two different populations.</p>
<section id="difference-of-two-proportions" class="level2">
<h2 class="anchored" data-anchor-id="difference-of-two-proportions">Difference of two proportions</h2>
<p>Suppose we have two populations 1 and 2, and want to either estimate the value of or conduct a test for the <strong>difference in population proportions</strong>: <span class="math inline">\(p_{1} - p_{2}\)</span></p>
<ul>
<li><p>We have samples of size <span class="math inline">\(n_{1}\)</span> and <span class="math inline">\(n_{2}\)</span> from each population</p></li>
<li><p>Reasonable point estimate: <span class="math inline">\(\hat{p}_{1, obs} - \hat{p}_{2,obs}\)</span></p></li>
<li><p>We will obtain the sampling distribution of the difference of two sample proportions</p></li>
<li><p><strong>Now that we have two populations, conditions for CLT will look slightly different!</strong></p></li>
</ul>
</section>
<section id="sampling-dist.-of-difference-of-two-proportions" class="level2">
<h2 class="anchored" data-anchor-id="sampling-dist.-of-difference-of-two-proportions">Sampling dist. of difference of two proportions</h2>
<ul>
<li><p>In order to use CLT approximation, we have to ensure conditions are met:</p>
<ol type="1">
<li><strong>Independence (extended)</strong>: data are independent within <em>and</em> between groups</li>
<li><strong>Success-failure (extended)</strong>: success-failure conditions holds for <strong><em>both</em></strong> groups
<ul>
<li><span class="math inline">\(n_{1} p_{1} \geq 10\)</span>, <span class="math inline">\(n_{1} (1-p_{1}) \geq 10\)</span>, <span class="math inline">\(n_{2} p_{2} \geq 10\)</span>, and <span class="math inline">\(n_{2} (1-p_{2}) \geq 10\)</span></li>
</ul></li>
</ol></li>
<li><p>If above hold, then:</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\hat{p}_{1} - \hat{p}_{2} \overset{\cdot}{\sim} N\left(p_{1} - p_{2}, \sqrt{\frac{p_{1} (1-p_{1})}{n_{1}} + \frac{p_{2} (1-p_{2})}{n_{2}}} \right)
\]</span></p>
<p>where <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}\)</span> are the population proportions</p>
</div>
</section>
<section id="confidence-interval-for-difference-in-proportions" class="level2">
<h2 class="anchored" data-anchor-id="confidence-interval-for-difference-in-proportions">Confidence interval for difference in proportions</h2>
<p>If we want to obtain a <span class="math inline">\(\gamma\times 100\%\)</span> CI for <span class="math inline">\(p_{1} - p_{2}\)</span>, that means we don’t know the value of <span class="math inline">\(p_{1} - p_{2}\)</span>!</p>
<ul>
<li><p>Like in the case of the CI for a single proportion, we will use our observed proportions to check success-failure</p></li>
<li><div class="important">
<p><strong>Success-failure condition for CI for difference in proportions:</strong></p>
</div>
<ul>
<li><p><span class="math inline">\(n_{1} \hat{p}_{1,obs} \geq 10\)</span> and <span class="math inline">\(n_{1} (1-\hat{p}_{1,obs}) \geq 10\)</span></p></li>
<li><p><span class="math inline">\(n_{2} \hat{p}_{2,obs} \geq 10\)</span> and <span class="math inline">\(n_{2} (1-\hat{p}_{2,obs}) \geq 10\)</span></p></li>
</ul></li>
<li><p>Then our formula for the CI is the same as before:</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\begin{align*}
&amp;\text{point. est} \pm \text{critical val.}\times \widehat{\text{SE}} = \\
&amp;(\hat{p}_{1,obs} - \hat{p}_{2,obs}) \pm z^{*}_{(1+\gamma)/2} \sqrt{\frac{\hat{p}_{1,obs} (1-\hat{p}_{1,obs})}{n_{1}} + \frac{\hat{p}_{2,obs} (1-\hat{p}_{2,obs})}{n_{2}}}
\end{align*}
\]</span></p>
</div>
</section>
<section id="diff.-props-ci-example-offshore-drilling" class="level2">
<h2 class="anchored" data-anchor-id="diff.-props-ci-example-offshore-drilling">Diff. props CI example: offshore drilling</h2>
<p>A survey asked 592 randomly sampled registered voters in California: Do you support or oppose drilling for oil and natural gas off the Coast of California? We have the following distribution of responses separated by whether the respondent graduated from college:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'position'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">position</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">no</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">yes</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; border-right: 1px solid;">oppose</td>
<td style="text-align: left;">126</td>
<td style="text-align: left;">180</td>
<td style="text-align: left;">306</td>
</tr>
<tr class="even">
<td style="text-align: left; border-right: 1px solid;">support</td>
<td style="text-align: left;">132</td>
<td style="text-align: left;">154</td>
<td style="text-align: left;">286</td>
</tr>
<tr class="odd">
<td style="text-align: left; border-right: 1px solid;">total</td>
<td style="text-align: left;">258</td>
<td style="text-align: left;">334</td>
<td style="text-align: left;">592</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="discuss">
<p>Let’s obtain a 95% CI via the CLT for the difference in the proportion of college and non-college Californians who support offshore drilling.</p>
</div>
</section>
<section id="diff.-props-ci-example-cont." class="level2">
<h2 class="anchored" data-anchor-id="diff.-props-ci-example-cont.">Diff. props CI example (cont.)</h2>
<p>Let population 1 be college attendees, and population 2 be non-college attendees. We want a 95% CI for <span class="math inline">\(p_{1} - p_{2}\)</span>, where <span class="math inline">\(p_{i}\)</span> is the proportion of population <span class="math inline">\(i\)</span> who support offshore drilling.</p>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li><div class="discuss">
<p>Obtain useful statistics</p>
</div>
<ul>
<li><p><span class="math inline">\(n_{1} = 334\)</span>, <span class="math inline">\(n_{2} = 258\)</span></p></li>
<li><p><span class="math inline">\(\hat{p}_{1, obs} = \frac{154}{334} = 0.461\)</span></p></li>
<li><p><span class="math inline">\(\hat{p}_{2, obs} = \frac{132}{258} = 0.512\)</span></p></li>
</ul></li>
</ul>
</div><div class="column" style="width:60%;">
<ul>
<li><div class="discuss">
<p>Check conditions for CLT.</p>
</div>
<ul>
<li><p><strong>Independence (extended)</strong>? Randomly sampled</p></li>
<li><p><strong>Success-failure (extended)</strong>?</p>
<ul>
<li><span class="math inline">\(n_{1}\hat{p}_{1,obs} = 154 \geq 10\)</span></li>
<li><span class="math inline">\(n_{1}(1-\hat{p}_{1,obs}) = 180 \geq 10\)</span></li>
<li><span class="math inline">\(n_{2}\hat{p}_{2,obs} = 132 \geq 10\)</span></li>
<li><span class="math inline">\(n_{2}(1-\hat{p}_{2,obs}) = 126 \geq 10\)</span></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<ul>
<li>Since both conditions are met, we can proceed with the CLT.</li>
</ul>
</section>
<section id="diff.-props-ci-example-cont.-1" class="level2">
<h2 class="anchored" data-anchor-id="diff.-props-ci-example-cont.-1">Diff. props CI example (cont.)</h2>
<p>Collect the components of CI:</p>
<div class="columns">
<div class="column" style="width:35%;">
<ul>
<li><div class="discuss">
<p>Point estimate</p>
</div></li>
<li><div class="discuss">
<p>Critical value (code)</p>
</div></li>
<li><div class="discuss">
<p><span class="math inline">\(\text{SE}\)</span> or <span class="math inline">\(\widehat{\text{SE}}\)</span></p>
</div></li>
</ul>
</div><div class="column" style="width:65%;">
<ul>
<li><p><span class="math inline">\(\hat{p}_{1,obs} - \hat{p}_{2,obs} = 0.461 - 0.512 = -0.051\)</span></p></li>
<li><p><span class="math inline">\(z^{*}_{0.975} =\)</span> <code>qnorm(0.975, 0, 1)</code> <span class="math inline">\(\approx 1.96\)</span></p></li>
<li><p><span class="math inline">\(\widehat{\text{SE}} = \sqrt{\frac{0.461(1 - 0.461)}{334} + \frac{0.512(1 - 0.512)}{258}} = 0.041\)</span></p></li>
</ul>
</div>
</div>
<ul>
<li><p>So putting it all together, our 95% CI is:</p>
<p><span class="math display">\[
-0.051 \pm 1.96 \times 0.041 = (-0.131, 0.029)
\]</span></p></li>
<li><div class="discuss">
<p>Interpret!</p>
</div></li>
</ul>
</section>
<section id="hypothesis-test-for-difference-in-proportions" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-for-difference-in-proportions">Hypothesis test for difference in proportions</h2>
<p>Hypothesis tests for difference in proportions in this class will take the form:</p>
<div class="fragment">
<p><span class="math display">\[
\begin{align*}
H_{0}: p_{1} - p_{2}  &amp;= 0 \\
H_{A}: \ p_{1} - p_{2}  &amp;\neq 0\\
\text{ or }\ &amp;&lt;   \\
\text{ or }\ &amp;&gt;
\end{align*}
\]</span></p>
</div>
<ul>
<li><p>For success-failure condition for difference in two proportions, we don’t have null-hypothesized values for <span class="math inline">\(p_{1}\)</span> or <span class="math inline">\(p_{2}\)</span>.</p></li>
<li><p>So how do we check the condition??</p></li>
</ul>
</section>
<section id="pooled-proportion" class="level2">
<h2 class="anchored" data-anchor-id="pooled-proportion">Pooled proportion</h2>
<ul>
<li><p>Since <span class="math inline">\(H_{0}: p_{1} = p_{2}\)</span>, then under the null <span class="math inline">\(\hat{p}_{1,obs}\)</span> and <span class="math inline">\(\hat{p}_{2,obs}\)</span> come from the <strong><em>same</em></strong> population</p></li>
<li><p>So under this null, we use a special proportion called the <strong>pooled proportion</strong>:</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\hat{p}_{pooled} = \frac{\text{total # of successes from both samples}}{\text{combined sample size}}
\]</span></p>
<ul>
<li><div style="color: maroon">
<p>This is the best estimate of both <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}\)</span> if <span class="math inline">\(H_{0}: p_{1} = p_{2}\)</span> <em>is true</em>!</p>
</div></li>
</ul>
</div>
<ul>
<li>For this reason, <strong>use</strong> <span class="math inline">\(\hat{p}_{pooled}\)</span> <strong>to verify success-failure conditions for HT for difference of proportions:</strong>
<ul>
<li><span class="math inline">\(n_{1} \hat{p}_{pooled} \geq 10\)</span> and <span class="math inline">\(n_{1} (1-\hat{p}_{pooled}) \geq 10\)</span></li>
<li><span class="math inline">\(n_{2} \hat{p}_{pooled} \geq 10\)</span> and <span class="math inline">\(n_{2} (1-\hat{p}_{pooled}) \geq 10\)</span></li>
</ul></li>
</ul>
</section>
<section id="hypothesis-test-cont." class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-cont.">Hypothesis test (cont.)</h2>
<ol start="3" type="1">
<li>Obtain null distribution
<ul>
<li>If conditions satisfied, then we know the sampling distribution of <span class="math inline">\(\hat{p}_{1} - \hat{p}_{2}\)</span></li>
<li>To obtain the <strong>null distribution</strong> we assume <span class="math inline">\(H_{0}: p_{1} - p_{2} = 0\)</span> is true and we <span class="math inline">\(\hat{p}_{pooled}\)</span> to estimate <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}\)</span> to approximate standard error under the null:</li>
</ul></li>
</ol>
<div class="fragment">
<p><span class="math display">\[
\begin{align*}
\hat{p}_{1} - \hat{p}_{2} &amp;\overset{\cdot}{\sim} N\left(p_{1} - p_{2}, \sqrt{\frac{p_{1} (1-p_{1})}{n_{1}} + \frac{p_{2} (1-p_{2})}{n_{2}}}  \right) \qquad \text{(CLT)} \\ &amp;\overset{\cdot}{\sim} N\big(0, \underbrace{\sqrt{\frac{\hat{p}_{pooled}(1 - \hat{p}_{pooled})}{n_{1}} + \frac{\hat{p}_{pooled}(1 - \hat{p}_{pooled})}{n_{2}}}}_{\widehat{\text{SE}}_{0}} \big) \qquad (H_{0})
\end{align*}
\]</span></p>
</div>
</section>
<section id="hypothesis-test-cont.-1" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-cont.-1">Hypothesis test (cont.)</h2>
<p>Obtain test-statistic:</p>
<p><span class="math display">\[
z = \frac{\text{point estimate} - \text{null value}}{\text{SE}} \approx \frac{(\hat{p}_{1,obs} - \hat{p}_{2,obs}) - 0}{\widehat{\text{SE}}_{0}}
\]</span></p>
<ul>
<li><p>To obtain p-value, we want <span class="math inline">\(\text{Pr}(Z \geq z)\)</span> and/or <span class="math inline">\(\text{Pr}(Z \leq z)\)</span> where <span class="math inline">\(Z \sim N(0,1)\)</span></p>
<ul>
<li>Obtain using <code>pnorm(z, 0, 1)</code></li>
</ul></li>
</ul>
</section>
<section id="diff.-props-ht-example-offshore-drilling-again" class="level2">
<h2 class="anchored" data-anchor-id="diff.-props-ht-example-offshore-drilling-again">Diff. props HT example: offshore drilling (again)</h2>
<p>Using the same data as before, let’s answer the following question:</p>
<div style="color: maroon">
<p>Do the data provide strong evidence at the 0.05 level that the proportion of college graduates who support off-shore drilling in California is different than that of non-college graduates?</p>
</div>
<ul>
<li><p>Let <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}\)</span> be defined as before.</p></li>
<li><div class="discuss">
<p>Define hypotheses</p>
</div>
<ul>
<li><span class="math inline">\(H_{0}: p_{1} - p_{2} = 0\)</span> and <span class="math inline">\(H_{A}: p_{1} - p_{2} \neq 0\)</span></li>
</ul></li>
</ul>
</section>
<section id="diff.-props-ht-example-cont." class="level2">
<h2 class="anchored" data-anchor-id="diff.-props-ht-example-cont.">Diff. props HT example (cont.)</h2>
<div class="discuss">
<p>Obtain pooled proportion, and use it to check conditions for CLT.</p>
</div>
<ul>
<li><p><span class="math inline">\(\hat{p}_{pooled} =\frac{154 + 132}{334 + 258} = \frac{286}{592} = 0.483\)</span></p></li>
<li><p>Conditions</p>
<ul>
<li><p>Independence (extended): random sample</p></li>
<li><p>Success-failure (extended):</p>
<ul>
<li><p><span class="math inline">\(n_{1} \hat{p}_{pooled} = 334 \times 0.483 = 161.32 \geq 10\)</span></p></li>
<li><p><span class="math inline">\(n_{1} (1 - \hat{p}_{pooled}) = 334 \times (1 - 0.483) = 172.68 \geq 10\)</span></p></li>
<li><p><span class="math inline">\(n_{2} \hat{p}_{pooled} = 258 \times 0.483 = 124.61 \geq 10\)</span></p></li>
<li><p><span class="math inline">\(n_{2} (1 - \hat{p}_{pooled}) = 258 \times (1 - 0.483) = 133.39 \geq 10\)</span></p></li>
</ul></li>
</ul></li>
<li><p>Since conditions are met, we can proceed with CLT-based test!</p></li>
</ul>
</section>
<section id="diff.-props-ht-example-cont.-1" class="level2">
<h2 class="anchored" data-anchor-id="diff.-props-ht-example-cont.-1">Diff. props HT example (cont.)</h2>
<ul>
<li><div class="discuss">
<p>Find the null distribution for <span class="math inline">\(\hat{p}_{1} - \hat{p}_{2}\)</span>.</p>
</div></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\hat{p}_{1} - \hat{p}_{2} \overset{\cdot}{\sim}N\left(0, \sqrt{\frac{0.483(1 - 0.483)}{334} + \frac{0.483(1 - 0.483)}{258}} = 0.041 \right)
\]</span></p>
</div>
<ul>
<li><div class="discuss">
<p>Set up calculation for test statistic</p>
</div></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
    z =\frac{( \hat{p}_{1, obs}- \hat{p}_{2, obs}) - 0}{\widehat{\text{SE}}_{0}} = \frac{(0.461 - 0.512) - 0}{0.041} = -1.244
\]</span></p>
</div>
</section>
<section id="diff.-props-ht-example-cont.-2" class="level2">
<h2 class="anchored" data-anchor-id="diff.-props-ht-example-cont.-2">Diff. props HT example (cont.)</h2>
<div class="discuss">
<p>Draw picture and write code for p-value</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="slides-22-ht-ci-diffs_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>p-value calculation:</p>
<ul>
<li><p><span class="math inline">\(\text{Pr}(Z \leq z) + \text{Pr}(Z \geq -z)\)</span></p></li>
<li><p><code>2 * pnorm(-1.244, 0, 1)</code> = 0.2134996</p></li>
</ul></li>
</ul>
</div>
</div>
<div class="fragment">
<div class="discuss">
<p>Make a decision and conclusion in context.</p>
</div>
</div>
<ul>
<li>Since our p-value is greater than 0.05, we fail to reject <span class="math inline">\(H_{0}\)</span>. The data do not provide strong evidence of a difference between the proportions of college graduates and non-college graduates who support off-shore drilling among California voters.</li>
</ul>
</section>
</section>
<section id="difference-in-two-means" class="level1">
<h1>Difference in two means</h1>
<section id="difference-in-two-means-1" class="level2">
<h2 class="anchored" data-anchor-id="difference-in-two-means-1">Difference in two means</h2>
<p>We still have two populations, but the variable of interest is quantitative (i.e.&nbsp;not binary).</p>
<p>We are interested in learning about the difference in the means of each population.</p>
<ul>
<li><p>Let <span class="math inline">\(\mu_{1}\)</span> and <span class="math inline">\(\mu_{2}\)</span> represent the population means for the two populations 1 and 2</p></li>
<li><p>Samples of size <span class="math inline">\(n_{1}\)</span> and <span class="math inline">\(n_{2}\)</span> from each population, respectively</p></li>
<li><p><strong>Conditions for CLT</strong></p>
<ol type="1">
<li><p><strong>Independence</strong> (extended): need data within <em>and</em> between the two groups</p>
<ul>
<li>e.g.the two data sets come from independent random samples or from a randomized experiment</li>
</ul></li>
<li><p><strong>Normality</strong>: we need to check for approximate normality for <strong><em>both</em></strong> groups separately</p></li>
</ol></li>
</ul>
</section>
<section id="clt-for-difference-in-two-sample-means" class="level2">
<h2 class="anchored" data-anchor-id="clt-for-difference-in-two-sample-means">CLT for difference in two sample means</h2>
<p>If CLT conditions met, the distribution of difference in sample means is:</p>
<div class="fragment">
<p><span class="math display">\[
\bar{X}_{1} - \bar{X}_{2} \overset{\cdot}{\sim} N\left(\mu_{1} - \mu_{2}, \sqrt{\frac{\sigma_{1}^2}{n_{1}} + \frac{\sigma_{2}^2}{n_{2}}} \right)
\]</span> where <span class="math inline">\(n_{1}\)</span> and <span class="math inline">\(n_{2}\)</span> are the sample sizes.</p>
</div>
<ul>
<li>Remember, we often do not know <span class="math inline">\(\sigma_{1}\)</span> nor <span class="math inline">\(\sigma_{2}\)</span></li>
<li>In practice, will have to estimate with <span class="math inline">\(s_{1}\)</span> and <span class="math inline">\(s_{2}\)</span> and use the <span class="math inline">\(t\)</span>-distribution</li>
</ul>
</section>
<section id="ci-for-difference-in-two-means" class="level2">
<h2 class="anchored" data-anchor-id="ci-for-difference-in-two-means">CI for difference in two means</h2>
<p>If the conditions hold, then our usual formula for <span class="math inline">\(\gamma \times 100\%\)</span> CI still holds:</p>
<p><span class="math display">\[
\text{point estimate} \pm \text{critical value} \times \text{SE}
\]</span></p>
<p>Point estimate: <span class="math inline">\(\bar{x}_{1,obs} - \bar{x}_{2,obs}\)</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment" style="color: maroon">
<p>If <span class="math inline">\(\sigma_{1}\)</span> and <span class="math inline">\(\sigma_{2}\)</span> known:</p>
</div>
<ul>
<li><p><span class="math inline">\(\text{SE} = \sqrt{\frac{\sigma_{1}^2}{n_{1}} + \frac{\sigma_{2}^2}{n_{2}}}\)</span></p></li>
<li><p>Critical value: <span class="math inline">\(z_{(1+\gamma)/2}^*\)</span></p>
<ul>
<li><span class="math inline">\((1+\gamma)/2\)</span> percentile of <span class="math inline">\(N(0,1)\)</span></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="fragment" style="color: maroon">
<p>If <span class="math inline">\(\sigma_{1}\)</span> and <span class="math inline">\(\sigma_{2}\)</span> unknown:</p>
</div>
<ul>
<li><p><span class="math inline">\(\widehat{\text{SE}} \approx \sqrt{\frac{s_{1}^2}{n_{1}} + \frac{s_{2}^2}{n_{2}}}\)</span></p></li>
<li><p>critical value: <span class="math inline">\(t_{df, (1+\gamma)/2}^*\)</span></p>
<ul>
<li><p><span class="math inline">\((1+\gamma)/2\)</span> percentile of <span class="math inline">\(t_{df}\)</span></p></li>
<li><p><span class="math inline">\(df = \min\{n_{1} -1, n_{2} - 1\}\)</span></p></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="diff.-means-ci-example-c02-concentrations" class="level2">
<h2 class="anchored" data-anchor-id="diff.-means-ci-example-c02-concentrations">Diff. means CI example: C02 concentrations</h2>
<ul>
<li><p>The Mauna Loa Observatory in Hawaii of monitors atmospheric solar, atmospheric, and meteorological parameters</p></li>
<li><p>We have data on annual atmospheric CO2 concentrations from 1980-2015.</p></li>
<li><div class="important">
<p>We will obtain a 90% confidence interval for the difference between the average atmospheric C02 levels (ppm) from years 2000-2015 and years 1980-1999.</p>
</div></li>
</ul>
<div class="fragment">
<div class="columns">
<div class="column" style="width:&quot;50%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 66 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (3): year, mean, unc

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="slides-22-ht-ci-diffs_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:&quot;50%;">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">group</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">xbar</th>
<th style="text-align: right;">s</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1980-1999</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">353.12</td>
<td style="text-align: right;">9.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2000-2015</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">385.02</td>
<td style="text-align: right;">9.9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="diff.-means-ci-example-cont." class="level2">
<h2 class="anchored" data-anchor-id="diff.-means-ci-example-cont.">Diff. means CI example (cont.)</h2>
<div class="discuss">
<p>Define parameters.</p>
</div>
<ul>
<li>Let <span class="math inline">\(\mu_{1}\)</span> be the average CO2 levels from 2000-2015 and <span class="math inline">\(\mu_{2}\)</span> the average CO2 levels from 1980-1999.</li>
<li>Want to obtain a 90% CI for <span class="math inline">\(\mu_{1} - \mu_{2}\)</span>
<ul>
<li>Note: could also do <span class="math inline">\(\mu_{2} - \mu_{1}\)</span> (interpretation just changes slightly)</li>
</ul></li>
</ul>
<div class="fragment">
<div class="discuss">
<p>Check conditions for CLT.</p>
</div>
</div>
<ul>
<li><p>Independence (extended): most likely violated because CO2 levels are probably dependent across time. BUT let’s proceed with caution anyway.</p></li>
<li><p>Normality: <span class="math inline">\(n_{1} = 16 &lt; 30\)</span> and <span class="math inline">\(n_{2} = 20 &lt; 30\)</span>. But since histograms don’t reveal outliers, Normality condition appears met.</p></li>
</ul>
</section>
<section id="diff.-means-ci-example-cont.-1" class="level2">
<h2 class="anchored" data-anchor-id="diff.-means-ci-example-cont.-1">Diff. means CI example (cont.)</h2>
<div class="discuss">
<p>Collect components for CI:</p>
</div>
<div class="columns">
<div class="column" style="width:35%;">
<ul>
<li><p>Point estimate</p></li>
<li><p>Critical value (code)</p></li>
<li><p><span class="math inline">\(\text{SE}\)</span> or <span class="math inline">\(\widehat{\text{SE}}\)</span></p></li>
</ul>
</div><div class="column" style="width:65%;">
<ul>
<li><p><span class="math inline">\(\bar{x}_{1,obs} - \bar{x}_{2,obs} = 385.02 - 353.12 = 31.9\)</span></p></li>
<li><p>Since we don’t know <span class="math inline">\(\sigma_{1}\)</span> nor <span class="math inline">\(\sigma_{2}\)</span>, need to use <span class="math inline">\(t\)</span>-distribution</p>
<ul>
<li><p>Degrees of freedom = <span class="math inline">\(\min\{16 - 1, 20 -1\} = 15\)</span></p></li>
<li><p><span class="math inline">\(t^*_{0.95}\)</span> = <code>qt(0.95, df = 15)</code> = 1.75</p></li>
</ul></li>
<li><p><span class="math inline">\(\widehat{\text{SE}} = \sqrt{\frac{9.9^2}{16} + \frac{9^2}{20}} = 3.19\)</span></p></li>
</ul>
</div>
</div>
<ul>
<li><div class="discuss">
<p>Put it all together:</p>
</div></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\text{point est.} \pm \text{crit. val}\times \text{SE} = 31.9 \pm 1.75 \times 3.19 = (26.3175, 37.4825)
\]</span></p>
</div>
</section>
<section id="diff.-means-ci-example-cont.-2" class="level2">
<h2 class="anchored" data-anchor-id="diff.-means-ci-example-cont.-2">Diff. means CI example (cont.)</h2>
<div class="discuss">
<p>Interpret our CI of (26.3175, 37.4825) in context!</p>
</div>
</section>
<section id="hypothesis-test-for-difference-in-means" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-for-difference-in-means">Hypothesis test for difference in means</h2>
<p>Now suppose we’re interested in testing for the difference between <span class="math inline">\(\mu_{1}\)</span> and <span class="math inline">\(\mu_{2}\)</span>.</p>
<ul>
<li><p><span class="math inline">\(H_{0}: \mu_{1} - \mu_{2} = 0\)</span> versus <span class="math inline">\(H_{A}: \mu_{1} - \mu_{2} \neq 0\)</span> (or <span class="math inline">\(&lt;\)</span> or <span class="math inline">\(&gt;\)</span>)</p></li>
<li><p>Same conditions as in CI are necessary for CLT-based inference!</p>
<ol type="1">
<li>Independence (extended)</li>
<li>Normality condition for <strong>both</strong> groups</li>
</ol></li>
<li><p>If CLT met, then under <span class="math inline">\(H_{0}\)</span>, the <strong>null distribution</strong> is</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\bar{X}_{1} - \bar{X}_{2} \overset{\cdot}{\sim} N\left(0, \sqrt{\frac{\sigma_{1}^2}{n_{1}} + \frac{\sigma_{2}^2}{n_{2}}} \right)
\]</span></p>
</div>
</section>
<section id="test-statistic-for-difference-in-means" class="level2">
<h2 class="anchored" data-anchor-id="test-statistic-for-difference-in-means">Test statistic for difference in means</h2>
<p>Test-statistic is of form:</p>
<p><span class="math display">\[
\frac{\text{point est.} - \text{null value}}{\text{SE}_{0}}
\]</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>If <span class="math inline">\(\sigma_{1}, \sigma_{2}\)</span> known, our test-statistic is:</p>
<p><span class="math display">\[
z = \frac{(\bar{x}_{1,obs} - \bar{x}_{2,obs}) - 0}{ \sqrt{\frac{\sigma_{1}^2}{n_{1}} + \frac{\sigma_{2}^2}{n_{2}}}} \sim N(0,1)
\]</span></p>
</div><div class="column" style="width:50%;">
<p>If <span class="math inline">\(\sigma_{1}, \sigma_{2}\)</span> unknown, our test-statistic is</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
t = \frac{(\bar{x}_{1,obs} - \bar{x}_{2,obs}) - 0}{ \sqrt{\frac{s_{1}^2}{n_{1}} + \frac{s_{2}^2}{n_{2}}}} \sim t_{df}
\]</span></p>
<p><span class="math inline">\(df = \min\{n_{1}-1, n_{2}-1 \}\)</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="diff.-means-ht-example-co2" class="level2">
<h2 class="anchored" data-anchor-id="diff.-means-ht-example-co2">Diff. means HT example: CO2</h2>
<p>Now let’s test if the mean CO2 level in 2000-2015 was greater than that mean CO2 level in 1980-1999 at the <span class="math inline">\(0.05\)</span> level using CLT.</p>
<ol type="1">
<li><span class="math inline">\(H_{0}: \mu_{1} - \mu_{2} = 0\)</span> versus <span class="math inline">\(H_{A}: \mu_{1} &gt; \mu_{2}\)</span>, where <span class="math inline">\(\mu_{1}\)</span> and <span class="math inline">\(\mu_{2}\)</span> were defined previously</li>
<li>Let <span class="math inline">\(\alpha = 0.05\)</span></li>
<li>Conditions for CLT are same as before (proceed with caution)</li>
</ol>
</section>
<section id="diff.-means-ht-example-cont." class="level2">
<h2 class="anchored" data-anchor-id="diff.-means-ht-example-cont.">Diff. means HT example (cont.)</h2>
<p>Obtain test-statistic and p-value.</p>
<ul>
<li><div class="discuss">
<p>Find the value of the test-statistic and its distribution</p>
</div></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
t = \frac{(385.02 - 353.12)- 0}{3.19} = 10 \sim t_{15}
\]</span></p>
</div>
<ul>
<li><div class="discuss">
<p>Write code for p-value (optionally draw picture)</p>
</div></li>
<li>p-value = <code>1- pt(10, df = 15)</code> = 0 (tiny!)</li>
</ul>
<!--
# Hypothesis test for mean paired difference

## Paired data (recap)

-   Recall paired data: we have two set of data $\boldsymbol{x}$ and $\boldsymbol{y}$ where each $x_{i}$ has a corresponding to one $y_{i}$

    -   Can obtain differences $d_{i} = y_{i} - x_{i}$

    -   We are interested in the true mean difference $\mu_{d}$

-   Recall: if observational units are independent and the differences are approximately Normal, then CLT gives us:

::: fragment
$$
\bar{d} \overset{\cdot}{\sim} N\left(\mu_{d}, \frac{\sigma_{d}}{\sqrt{n}}\right)
$$
:::

-   We don't typically know $\sigma_{d}$, so replace with sample $s_{d}$ (and then use $t$ distribution)

## Hypothesis test

-   Hypotheses: $H_0: \mu_{d} = \mu_{0}$ versus $H_{A}: \mu_{d} \neq \mu_0$ (or $>$ or $<$ )

-   Obtain summary statistics $\bar{d}_{obs}$ and $s_{d}$

-   ::: discuss
    Check if CLT holds. If so, what is our **null distribution**?
    :::

::: fragment
$$
\bar{d} \overset{\cdot}{\sim} N\left(\mu_0, \frac{\sigma_{d}}{\sqrt{n}} \right)
$$
:::

-   ::: discuss
    Because we don't know $\sigma_{d}$, our **test statistic** here is:
    :::

::: fragment
$$
t = \frac{\bar{d}_{obs} - \mu_0}{\frac{s_{d}}{\sqrt{n}}} \sim t_{df}
$$

where $df = n-1$
:::

## Example: zinc (revisited)

::: {.cell}

:::

Data consist of measured zinc concentrations in bottom water and surface water at 10 randomly sampled wells:

::: {style="color: maroon"}
Do the data suggest that the true average concentration in the bottom water is greater than that of surface water? Let's now answer this using a hypothesis test at the 0.05 level.
:::

-   ::: discuss
    Define parameters and hypotheses
    :::

    -   Let $\mu_{d}$ be the true mean difference between zinc concentrations (bottom-surface)
    -   $H_{0}: \mu_{d} = 0$ versus $H_{A}: \mu_{d} > 0$

-   Last week, we saw conditions for CLT were satisfied

## Example: zinc (cont.)

::: {.cell}

```{.r .cell-code}
zinc <- zinc |>
  mutate(d = bottom - surface)
d_bar <- mean(zinc$d)
d_bar
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.0804
```


:::

```{.r .cell-code}
s_d <- sd(zinc$d)
s_d
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.05227321
```


:::
:::

::: {.cell}

:::

::: discuss
Find the test-statistic
:::

## Example: zinc (cont.)

::: fragment
$$t = \frac{\bar{d}_{obs} - \mu_{0}}{s_{d}/\sqrt{n}} = \frac{0.0804 - 0}{0.052/\sqrt{10}} = 4.889  \sim t_{9}$$
:::

-   So our p-value is $\text{Pr}(T \geq t) = \text{Pr}(T \geq 4.889) = 1 - \texttt{pt(4.889, 9)} = 0$

-   We reject $H_{0}$! The data provide convincing evidence that zinc concentrations of bottom well water is greater than those of surface water.

# Hypothesis test for difference in means

## Sampling distribution for difference in means

-   Two populations, interest in $\mu_{1} - \mu_{2}$ (or other order)

-   Samples of size $n_{1}$ and $n_{2}$

-   If CLT holds, we learned sampling distribution of difference in sample means is:

::: fragment
$$
\bar{X}_{1} - \bar{X}_{2} \overset{\cdot}{\sim} N\left(\mu_{1} - \mu_{2}, \sqrt{\frac{\sigma_{1}^2}{n_{1}} + \frac{\sigma_{2}^2}{n_{2}}} \right)
$$
:::

-   When we don't know the population standard deviations, we replace the $\sigma$ with $s$ and use a $t$ distribution

-   Same thing will happen for hypothesis test!

    -   ::: {style="color: maroon"}
        Same conditions for inference: independence (extended) and approximate normality/large sample size (extended)
        :::

## Hypothesis test

Hypotheses $H_{0}: \mu_{1} = \mu_{2}$ versus $H_{A}: \mu_{1} \neq \mu_{2}$ (or $>$ or $<$)

-   If CLT holds, our **null distribution** for the difference in sample means is:

::: fragment
$$
\bar{X}_{1} - \bar{X}_{2} \overset{\cdot}{\sim} N\left(0, \sqrt{\frac{\sigma_{1}^2}{n_{1}} + \frac{\sigma_{2}^2}{n_{2}} }\right)
$$
:::

-   ::: discuss
    In practice, use $s_{1}$ and $s_{2}$. So our **test-statistic** is...
    :::

::: fragment
$$
t= \frac{\text{point est} - \text{null value} }{\widehat{\text{SE}}_{0}} = \frac{(\bar{x}_{1} - \bar{x}_{2}) - 0}{\sqrt{\frac{s_{1}^2}{n_{1}} + \frac{s_{2}^2}{n_{2}}}} \sim t_{df}
$$

where $df = \min(n_{1}-1, n_{2}-1)$
:::

## Activity

Munchkins!

# CI for paired mean

## Paired data

Suppose we have two sets of observations/data $\boldsymbol{x} = (x_{1}, x_{2}, \ldots x_{n})$ and $\boldsymbol{y} = (y_{1}, y_{2}, \ldots, y_{n})$

-   The data are considered **paired data** if each $x_{i}$ corresponds to exactly one $y_{i}$

-   Example: your score on the midterm and your score on the final

-   When analyzing paired data, we are typically interested in the difference in outcomes of each pair of observations

## Paired differences

-   Let $d_{i} = y_{i} - x_{i}$ for each $i = 1,\ldots, n$ be the observed differences

-   The $d_{i}$ come from larger population with true mean difference $\mu_{d}$ and standard deviation of differences $\sigma_{d}$

-   The sample mean difference and sample standard deviation of the differences are

::: fragment
$$\bar{d} = \frac{1}{n}\sum_{i=1}^{n} d_{i} \qquad \qquad s_{d} = \frac{1}{n-1}\sum_{i=1}^{n} (d_{i} - \bar{d})^2 $$
:::

## CLT for mean difference in pairs

-   Suppose the $n$ observational units are independent and the distribution of the differences is approximately normal. Then CLT says:

    $$
    \bar{d} \overset{\cdot}{\sim} N\left(\mu_{d}, \frac{\sigma_{d}}{\sqrt{n}} \right)
    $$

-   We are usually interested in performing inference for $\mu_{d}$ when both $\mu_{d}$ and $\sigma_{d}$ unknown

-   Our formula for $\gamma\times 100\%$ CI for $\mu_{d}$ is analogous to the formula for one mean when $\sigma$ unknown:

::: fragment
$$
\begin{align*}
\text{point estimate} &\pm t^*_{df, (1+\gamma)/2} \times \widehat{\text{SE}} \\
\bar{d} &\pm t_{df, (1+\gamma)/2}^* \times \frac{s_{d}}{\sqrt{n}}
\end{align*}
$$

where $df = n-1$
:::

## Example: zinc

::: {.cell}

:::

Data consist of measured zinc concentrations in bottom water and surface water at 10 randomly sampled wells:

::: {style="color: maroon"}
Do the data suggest that the true average concentration in the bottom water is different than that of surface water? Let's answer this using a 95% confidence interval.
:::

::::::: columns
::: {.column width="50%"}
::: {.cell}
::: {.cell-output-display}
![](slides-22-ht-ci-diffs_files/figure-html/unnamed-chunk-13-1.png){width=672}
:::
:::
:::

::::: {.column width="50%"}
:::: fragment
::: {.cell}
::: {.cell-output .cell-output-stdout}

```
  bottom surface
1  0.430   0.415
2  0.266   0.238
3  0.567   0.390
4  0.531   0.410
5  0.707   0.605
6  0.716   0.609
```


:::
:::

::: discuss
Are the data paired? Does CLT apply?
:::
::::
:::::
:::::::

## Example: zinc (cont.)

::::: columns
::: {.column width="40%"}
::: {.cell}

```{.r .cell-code}
zinc <- zinc |>
  mutate(d = bottom - surface)
d_bar <- mean(zinc$d)
d_bar
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.0804
```


:::

```{.r .cell-code}
s_d <- sd(zinc$d)
s_d
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.05227321
```


:::
:::

::: {.cell}

:::
:::

::: {.column width="60%"}
1.  point estimate: $\bar{d} = 0.0804$

2.  SE $\approx$ $\frac{s_{d}}{\sqrt{n}} = \frac{0.052}{\sqrt{10}} = 0.016$

3.  ::: discuss
    critical value: what code would you write?
    :::

    -   $df = n-1 = 9$

    -   $t_{9, 0.975}^{*} =$ `qt(0.975,9)` $= 2.26$
:::
:::::

::: fragment
So our 95% confidence interval is:

$$0.0804 \pm 2.26(0.016) = (0.044, 0.117)$$
:::

:::: fragment
::: {style="color: maroon"}
Do the data suggest that the true average concentration in the bottom water is different than that of surface water? Explain.
:::
::::
-->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>